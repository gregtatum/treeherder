(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1235:function(t,e,n){t.exports=n(1253)},1253:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),i=n(41),s=n(3),a=n(22),c=n(587),u=n(28);class l extends o.a.PureComponent{constructor(t){super(t),this.getCredentials=async t=>{const e=localStorage.getItem("tcRootUrl");if(!e)return void this.setState({errorMessage:u.c});let n=await this.fetchToken(t,e);n.failureStatus?this.setState({errorMessage:u.c}):(n=await this.fetchCredentials(n.data.access_token,e),n.failureStatus?this.setState({errorMessage:u.c}):(localStorage.setItem("userCredentials",JSON.stringify({[e]:n.data})),window.opener?window.close():window.location.href=window.origin))},this.fetchToken=async(t,e)=>{const n={method:"POST",body:`grant_type=authorization_code&code=${t}&redirect_uri=${u.e}&client_id=${u.b}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}};return Object(a.c)(e+"/login/oauth/token",n)},this.fetchCredentials=async(t,e)=>{const n={mode:"cors",headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"}};return Object(a.c)(e+"/login/oauth/credentials",n)},this.state={errorMessage:""}}componentDidMount(){const{code:t,state:e}=Object(s.x)(window.location.search),n=localStorage.getItem("requestState");t&&n&&n===e?this.getCredentials(t):this.setState({errorMessage:u.c})}render(){const{errorMessage:t}=this.state;return o.a.createElement(c.a,{errorMessage:t,text:"Getting Taskcluster credentials..."})}}Object(i.render)(o.a.createElement(l,null),document.getElementById("root"))},134:function(t,e,n){var r,o;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(i){if(void 0===(o="function"==typeof(r=i)?r.call(e,n,e,t):r)||(t.exports=o),!0,t.exports=i(),!!0){var s=window.Cookies,a=window.Cookies=i();a.noConflict=function(){return window.Cookies=s,a}}}((function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function i(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=t({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(t){}n=r.write?r.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in i)i[c]&&(a+="; "+c,!0!==i[c]&&(a+="="+i[c].split(";")[0]));return document.cookie=e+"="+n+a}}function s(t,n){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],s=0;s<i.length;s++){var a=i[s].split("="),c=a.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=e(a[0]);if(c=(r.read||r)(c,u)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(o[u]=c,t===u)break}catch(t){}}return t?o[t]:o}}return o.set=i,o.get=function(t){return s(t,!1)},o.getJSON=function(t){return s(t,!0)},o.remove=function(e,n){i(e,"",t(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))}))},22:function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"e",(function(){return f})),n.d(e,"d",(function(){return d}));var r=n(134),o=n.n(r),i=n(33);const s=function(){return new Headers({"X-CSRFToken":o.a.get("csrftoken"),Accept:"application/json","Content-Type":"application/json"})},a=async function(t,e={}){let n=null;const r=await fetch(t,e);if(r.ok||(n=r.status),r.headers.get("content-type").startsWith("text/html")&&n){return{data:Object(i.c)(`${n}: ${r.statusText}`,n),failureStatus:n}}let o=await r.json();return n&&(o=Object(i.c)(o,n)),{data:o,failureStatus:n}},c=function(t,e){return a(t,{method:"POST",headers:s(),body:JSON.stringify(e),credentials:"same-origin"})},u=function(t,e){return a(t,{method:"PUT",headers:s(),body:JSON.stringify(e),credentials:"same-origin"})},l=function(t){return fetch(t,{method:"DELETE",headers:s(),credentials:"same-origin"})},f=(t,e,n)=>{const{data:r,failureStatus:o}=t;return o?{errorMessages:[...n,r]}:{[e]:r}},d=t=>{const e=[];return t.forEach(t=>{t.failureStatus&&e.push(t.data)}),e}},28:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"e",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"a",(function(){return c}));var r=n(3);const o="treeherder-"+{"https://treeherder.mozilla.org":"production","https://treeherder.allizom.org":"stage","https://treeherder-prototype.herokuapp.com":"dev","http://localhost:5000":"localhost","https://treeherder-taskcluster-staging.herokuapp.com":"taskcluster-staging","https://treeherder-prototype2.herokuapp.com":"dev2"}[window.location.origin],i=`${window.location.origin}${r.B}`,s="There was a problem verifying your Taskcluster credentials. Please try again later.",a="https://firefox-ci-tc.services.mozilla.com",c=t=>t===a&&"treeherder-taskcluster-staging"===o?"https://stage.taskcluster.nonprod.cloudops.mozgcp.net":t},3:function(t,e,n){"use strict";n.d(e,"C",(function(){return i})),n.d(e,"d",(function(){return s})),n.d(e,"v",(function(){return a})),n.d(e,"h",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return l})),n.d(e,"u",(function(){return f})),n.d(e,"g",(function(){return d})),n.d(e,"w",(function(){return p})),n.d(e,"y",(function(){return h})),n.d(e,"z",(function(){return g})),n.d(e,"A",(function(){return m})),n.d(e,"B",(function(){return w})),n.d(e,"t",(function(){return y})),n.d(e,"k",(function(){return b})),n.d(e,"f",(function(){return v})),n.d(e,"j",(function(){return k})),n.d(e,"l",(function(){return S})),n.d(e,"n",(function(){return $})),n.d(e,"s",(function(){return x})),n.d(e,"p",(function(){return C})),n.d(e,"q",(function(){return M})),n.d(e,"o",(function(){return T})),n.d(e,"r",(function(){return j})),n.d(e,"m",(function(){return O})),n.d(e,"x",(function(){return E})),n.d(e,"i",(function(){return U})),n.d(e,"e",(function(){return z})),n.d(e,"c",(function(){return P})),n.d(e,"D",(function(){return R}));var r=n(72),o=n.n(r);const i="/#/jobs",s="https://bugzilla.mozilla.org/",a="https://hg.mozilla.org/",c="https://dxr.mozilla.org/",u="/failures/",l="/failuresbybug/",f="/failurecount/",d="/revision.txt",p="/login.html",h="/machineplatforms/",g="/push/",m="/repository/",w="/taskcluster-auth.html",y=function(t,e){const{id:n,run:r}=t;return o.a.withRootUrl(e).api("queue","v1",`/task/${n}/runs/${r}/artifacts/public/runnable-jobs.json`)},b=t=>{const{taskId:e,run:n,rootUrl:r,artifactPath:i}=t;let s=o.a.withRootUrl(r).api("queue","v1",`/task/${e}/runs/${n}/artifacts`);return i&&(s+="/"+i),s},v=function(t){return"?"+(t instanceof URLSearchParams?t:new URLSearchParams(t)).toString()},k=function(t){return"/api"+t},S=function(t){return`${s}show_bug.cgi?id=${t}`},$=function(t,e,n){const r=n<1573257600?"https://taskcluster.net":e;return o.a.ui(r,"tasks/"+t)},x=function(t){return`https://hg.mozilla.org/mozilla-central/raw-file/tip/layout/tools/reftest/reftest-analyzer.xhtml#logurl=${t}&only_show_unexpected=1`},C=function(t,e,n){const r=`logviewer.html#?job_id=${t}&repo=${e}`;return n?`${r}&lineNumber=${n}`:r},M=function(t){return"https://profiler.firefox.com/from-url/"+encodeURIComponent(t)},T=function(t){return`${i}${v(t)}`},j=function(t){return"/pushhealth.html"+v(t)},O=function(t){return"perf.html#/comparechooser"+v(t)},E=function(t){return[...new URLSearchParams(t).entries()].reduce((t,[e,n])=>({...t,[e]:n}),{})},U=function(t){const e=t.split("?");return e[e.length-1]},z=function(t,e){return`${k(t)}${v(e)}`},P=function(t,e){const n=v(e);return`${s}rest/${t}${n}`},R=function(t,e,n){e.replace({pathname:n.pathname,search:t}),n.search=t}},33:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i}));const r=function(t,e){return 401===t.status||403===t.status?"Please login to Treeherder to complete this action":`${e}: ${`${t.data&&t.data.detail||t.status} ${t.statusText}`}`},o=function(t){const e=t.body||t,n=e.message||e.toString();return-1!==n.indexOf("----")?"Taskcluster: "+n.split("----")[0]:"Taskcluster: "+n},i=function(t,e){if(e>=500)return"There was a problem retrieving the data. Please try again in a minute.";if(t instanceof Object){const e=Object.keys(t);return`${e}: ${t[e]}`}return t}},587:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(455),s=n(78);const a=({errorMessage:t,text:e})=>o.a.createElement("div",{className:"pt-5"},t?o.a.createElement(s.a,{failureMessage:t}):o.a.createElement(i.a,{className:"justify-content-center"},o.a.createElement("p",{className:"lead text-center"},e)));a.defaultProps={errorMessage:""},e.a=a},78:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(499);class s extends o.a.PureComponent{constructor(t){super(t),this.state={visible:!0}}componentDidUpdate(t){const{errorMessages:e,failureMessage:n}=this.props;t.errorMessages===e&&t.failureMessage===n||this.state.visible||this.setState({visible:!0})}render(){const{errorMessages:t,failureMessage:e}=this.props,{visible:n}=this.state,r=t.length?t:[e];return o.a.createElement("div",null,r.map(t=>o.a.createElement(i.a,{color:"danger",isOpen:n,toggle:()=>this.setState({visible:!n}),key:t,className:"text-center"},t)))}}s.defaultProps={failureMessage:null,errorMessages:[]},e.a=s}},[[1235,0,1,2,5]]]);
//# sourceMappingURL=taskcluster-auth.1e60765a.js.map